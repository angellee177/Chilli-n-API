function cov_1fvy4x1q9i(){var path="/home/angellee/nodejs/AIA-MidFullstack-assessment/routes/index.js";var hash="1b6f8e6367f85dd72daeea422f72642522485a9c";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/angellee/nodejs/AIA-MidFullstack-assessment/routes/index.js",statementMap:{"0":{start:{line:1,column:43},end:{line:1,column:73}},"1":{start:{line:2,column:22},end:{line:2,column:40}},"2":{start:{line:3,column:22},end:{line:3,column:38}},"3":{start:{line:4,column:22},end:{line:4,column:40}},"4":{start:{line:5,column:22},end:{line:5,column:39}},"5":{start:{line:6,column:22},end:{line:6,column:91}},"6":{start:{line:10,column:0},end:{line:48,column:3}},"7":{start:{line:11,column:4},end:{line:47,column:5}},"8":{start:{line:12,column:8},end:{line:44,column:11}},"9":{start:{line:16,column:16},end:{line:43,column:17}},"10":{start:{line:18,column:38},end:{line:21,column:21}},"11":{start:{line:24,column:31},end:{line:24,column:54}},"12":{start:{line:27,column:36},end:{line:40,column:23}},"13":{start:{line:27,column:55},end:{line:40,column:21}},"14":{start:{line:42,column:20},end:{line:42,column:91}},"15":{start:{line:46,column:8},end:{line:46,column:106}},"16":{start:{line:52,column:0},end:{line:85,column:3}},"17":{start:{line:53,column:4},end:{line:84,column:5}},"18":{start:{line:54,column:22},end:{line:54,column:47}},"19":{start:{line:55,column:30},end:{line:57,column:103}},"20":{start:{line:59,column:8},end:{line:80,column:11}},"21":{start:{line:63,column:12},end:{line:79,column:13}},"22":{start:{line:65,column:32},end:{line:73,column:19}},"23":{start:{line:65,column:64},end:{line:73,column:17}},"24":{start:{line:75,column:16},end:{line:75,column:87}},"25":{start:{line:78,column:16},end:{line:78,column:104}},"26":{start:{line:83,column:8},end:{line:83,column:108}},"27":{start:{line:88,column:0},end:{line:88,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:25},end:{line:10,column:26}},loc:{start:{line:10,column:39},end:{line:48,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:11},end:{line:15,column:12}},loc:{start:{line:15,column:43},end:{line:44,column:9}},line:15},"2":{name:"(anonymous_2)",decl:{start:{line:27,column:45},end:{line:27,column:46}},loc:{start:{line:27,column:55},end:{line:40,column:21}},line:27},"3":{name:"(anonymous_3)",decl:{start:{line:52,column:33},end:{line:52,column:34}},loc:{start:{line:52,column:47},end:{line:85,column:1}},line:52},"4":{name:"(anonymous_4)",decl:{start:{line:62,column:11},end:{line:62,column:12}},loc:{start:{line:62,column:44},end:{line:80,column:9}},line:62},"5":{name:"(anonymous_5)",decl:{start:{line:65,column:54},end:{line:65,column:55}},loc:{start:{line:65,column:64},end:{line:73,column:17}},line:65}},branchMap:{"0":{loc:{start:{line:16,column:16},end:{line:43,column:17}},type:"if",locations:[{start:{line:16,column:16},end:{line:43,column:17}},{start:{line:16,column:16},end:{line:43,column:17}}],line:16},"1":{loc:{start:{line:16,column:20},end:{line:16,column:57}},type:"binary-expr",locations:[{start:{line:16,column:20},end:{line:16,column:26}},{start:{line:16,column:30},end:{line:16,column:57}}],line:16},"2":{loc:{start:{line:63,column:12},end:{line:79,column:13}},type:"if",locations:[{start:{line:63,column:12},end:{line:79,column:13}},{start:{line:63,column:12},end:{line:79,column:13}}],line:63},"3":{loc:{start:{line:63,column:16},end:{line:63,column:53}},type:"binary-expr",locations:[{start:{line:63,column:16},end:{line:63,column:22}},{start:{line:63,column:26},end:{line:63,column:53}}],line:63}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"1b6f8e6367f85dd72daeea422f72642522485a9c"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1fvy4x1q9i=function(){return actualCoverage;};}return actualCoverage;}cov_1fvy4x1q9i();const{errorResponse,successResponse}=(cov_1fvy4x1q9i().s[0]++,require('../helpers/response')),express=(cov_1fvy4x1q9i().s[1]++,require('express')),router=(cov_1fvy4x1q9i().s[2]++,express.Router()),request=(cov_1fvy4x1q9i().s[3]++,require('request')),moment=(cov_1fvy4x1q9i().s[4]++,require('moment')),feedList=(cov_1fvy4x1q9i().s[5]++,"https://api.flickr.com/services/feeds/photos_public.gne?format=json");// Get Feed List
cov_1fvy4x1q9i().s[6]++;router.get('/feed/list',(req,res)=>{cov_1fvy4x1q9i().f[0]++;cov_1fvy4x1q9i().s[7]++;try{cov_1fvy4x1q9i().s[8]++;request({url:feedList,json:true},function(error,response,body){cov_1fvy4x1q9i().f[1]++;cov_1fvy4x1q9i().s[9]++;if((cov_1fvy4x1q9i().b[1][0]++,!error)&&(cov_1fvy4x1q9i().b[1][1]++,response.statusCode===200)){cov_1fvy4x1q9i().b[0][0]++;// extract character from string
let mySubString=(cov_1fvy4x1q9i().s[10]++,body.substring(body.indexOf("[")-1,body.lastIndexOf("]")+1));// convert string to object 
let data=(cov_1fvy4x1q9i().s[11]++,JSON.parse(mySubString));// create new output data || reform a new output
let allPhotos=(cov_1fvy4x1q9i().s[12]++,data.map(photo=>{cov_1fvy4x1q9i().f[2]++;cov_1fvy4x1q9i().s[13]++;return{Static_URL:photo.media.m.toString().replace("\\",""),Flickr_URL:photo.link.toString().replace("\\",""),Owner_URL:'https://www.flickr.com/photos/'+photo.author_id,Title:photo.title,Description:photo.description,Published_date:moment(photo.published).format('MM MMMM YYYY'),Author:photo.author.substring(photo.author.indexOf("\"")+1,photo.author.lastIndexOf("\"")-1),Tags:photo.tags};}));cov_1fvy4x1q9i().s[14]++;res.status(200).json(successResponse("Success Fetch Data",allPhotos));}else{cov_1fvy4x1q9i().b[0][1]++;};});}catch(err){cov_1fvy4x1q9i().s[15]++;return res.status(422).json(errorResponse("something went wrong when trying to fetch data",err));}});// Get Images based on Images Tags
cov_1fvy4x1q9i().s[16]++;router.get('/feed/search/:tags',(req,res)=>{cov_1fvy4x1q9i().f[3]++;cov_1fvy4x1q9i().s[17]++;try{const query=(cov_1fvy4x1q9i().s[18]++,{tags:req.params.tags}),searchByTags=(cov_1fvy4x1q9i().s[19]++,`https://www.flickr.com/services/rest/?method=flickr.photos.search&`+`api_key=b525f14a53fff62a96c3d7c392b13ad4&`+`tags=${query.tags}&format=json&nojsoncallback=1&api_sig=dad2e45f8cd6f4555c16e50cc1c60552`);cov_1fvy4x1q9i().s[20]++;request({url:searchByTags,json:true},function(error,response,body){cov_1fvy4x1q9i().f[4]++;cov_1fvy4x1q9i().s[21]++;if((cov_1fvy4x1q9i().b[3][0]++,!error)&&(cov_1fvy4x1q9i().b[3][1]++,response.statusCode===200)){cov_1fvy4x1q9i().b[2][0]++;// create a new output Data and get the Photos detail
let allPhotos=(cov_1fvy4x1q9i().s[22]++,body.photos.photo.map(photo=>{cov_1fvy4x1q9i().f[5]++;cov_1fvy4x1q9i().s[23]++;return{Static_URL:'https://farm'+photo.farm+'.staticflickr.com/'+photo.server+'/'+photo.id+'_'+photo.secret+'_b.jpg',Flickr_URL:'https://www.flickr.com/photos/'+photo.owner+'/'+photo.id,Owner_URL:'https://www.flickr.com/photos/'+photo.owner,Title:photo.title,// Published_date: moment(photo.published).format('MM MMMM YYYY'),
Author:photo.owner// Tags      : photo.tags
};}));cov_1fvy4x1q9i().s[24]++;res.status(200).json(successResponse("Success Fetch Data",allPhotos));}else{cov_1fvy4x1q9i().b[2][1]++;cov_1fvy4x1q9i().s[25]++;res.status(422).json(errorResponse(`Cannot find the photos with tags ${query}`,error));}});}catch(err){cov_1fvy4x1q9i().s[26]++;return res.status(422).json(errorResponse("There is something went wrong, please try again!",err));}});cov_1fvy4x1q9i().s[27]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImVycm9yUmVzcG9uc2UiLCJzdWNjZXNzUmVzcG9uc2UiLCJyZXF1aXJlIiwiZXhwcmVzcyIsInJvdXRlciIsIlJvdXRlciIsInJlcXVlc3QiLCJtb21lbnQiLCJmZWVkTGlzdCIsImdldCIsInJlcSIsInJlcyIsInVybCIsImpzb24iLCJlcnJvciIsInJlc3BvbnNlIiwiYm9keSIsInN0YXR1c0NvZGUiLCJteVN1YlN0cmluZyIsInN1YnN0cmluZyIsImluZGV4T2YiLCJsYXN0SW5kZXhPZiIsImRhdGEiLCJKU09OIiwicGFyc2UiLCJhbGxQaG90b3MiLCJtYXAiLCJwaG90byIsIlN0YXRpY19VUkwiLCJtZWRpYSIsIm0iLCJ0b1N0cmluZyIsInJlcGxhY2UiLCJGbGlja3JfVVJMIiwibGluayIsIk93bmVyX1VSTCIsImF1dGhvcl9pZCIsIlRpdGxlIiwidGl0bGUiLCJEZXNjcmlwdGlvbiIsImRlc2NyaXB0aW9uIiwiUHVibGlzaGVkX2RhdGUiLCJwdWJsaXNoZWQiLCJmb3JtYXQiLCJBdXRob3IiLCJhdXRob3IiLCJUYWdzIiwidGFncyIsInN0YXR1cyIsImVyciIsInF1ZXJ5IiwicGFyYW1zIiwic2VhcmNoQnlUYWdzIiwicGhvdG9zIiwiZmFybSIsInNlcnZlciIsImlkIiwic2VjcmV0Iiwib3duZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoicWlJQWVZOzJGQWZaLEtBQU0sQ0FBRUEsYUFBRixDQUFpQkMsZUFBakIsMkJBQXFDQyxPQUFPLENBQUMscUJBQUQsQ0FBNUMsQ0FBTixDQUNNQyxPQUFPLDBCQUFTRCxPQUFPLENBQUMsU0FBRCxDQUFoQixDQURiLENBRU1FLE1BQU0sMEJBQVVELE9BQU8sQ0FBQ0UsTUFBUixFQUFWLENBRlosQ0FHTUMsT0FBTywwQkFBU0osT0FBTyxDQUFDLFNBQUQsQ0FBaEIsQ0FIYixDQUlNSyxNQUFNLDBCQUFVTCxPQUFPLENBQUMsUUFBRCxDQUFqQixDQUpaLENB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RyxDQUFDcUMsTUFBSixDQUFXLEdBQVgsRUFBZ0JuQyxJQUFoQixDQUFxQmIsYUFBYSxDQUFDLGtEQUFELENBQXFEaUQsR0FBckQsQ0FBbEMsQ0FBUCxDQUNILENBQ0osQ0FqQ0QsRSx5QkFvQ0FVLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQnhELE1BQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBlcnJvclJlc3BvbnNlLCBzdWNjZXNzUmVzcG9uc2UgfSA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvcmVzcG9uc2UnKVxuICAgICwgZXhwcmVzcyAgICAgICA9IHJlcXVpcmUoJ2V4cHJlc3MnKVxuICAgICwgcm91dGVyICAgICAgICA9IGV4cHJlc3MuUm91dGVyKClcbiAgICAsIHJlcXVlc3QgICAgICAgPSByZXF1aXJlKCdyZXF1ZXN0JylcbiAgICAsIG1vbWVudCAgICAgICAgPSByZXF1aXJlKCdtb21lbnQnKVxuICAgICwgZmVlZExpc3QgICAgICA9IFwiaHR0cHM6Ly9hcGkuZmxpY2tyLmNvbS9zZXJ2aWNlcy9mZWVkcy9waG90b3NfcHVibGljLmduZT9mb3JtYXQ9anNvblwiXG5cblxuLy8gR2V0IEZlZWQgTGlzdFxucm91dGVyLmdldCgnL2ZlZWQvbGlzdCcsIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIHJlcXVlc3Qoe1xuICAgICAgICAgICAgdXJsICAgICA6IGZlZWRMaXN0LFxuICAgICAgICAgICAganNvbiAgICA6IHRydWUsXG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSwgYm9keSkge1xuICAgICAgICAgICAgICAgIGlmICghZXJyb3IgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGV4dHJhY3QgY2hhcmFjdGVyIGZyb20gc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgIGxldCBteVN1YlN0cmluZyA9IGJvZHkuc3Vic3RyaW5nKFxuICAgICAgICAgICAgICAgICAgICAgICAgYm9keS5pbmRleE9mKFwiW1wiKSAtIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBib2R5Lmxhc3RJbmRleE9mKFwiXVwiKSArIDFcbiAgICAgICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnZlcnQgc3RyaW5nIHRvIG9iamVjdCBcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSBKU09OLnBhcnNlKG15U3ViU3RyaW5nKVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgb3V0cHV0IGRhdGEgfHwgcmVmb3JtIGEgbmV3IG91dHB1dFxuICAgICAgICAgICAgICAgICAgICBsZXQgYWxsUGhvdG9zID0gZGF0YS5tYXAocGhvdG8gPT4gKHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgU3RhdGljX1VSTDogcGhvdG8ubWVkaWEubS50b1N0cmluZygpLnJlcGxhY2UoXCJcXFxcXCIsIFwiXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgRmxpY2tyX1VSTDogcGhvdG8ubGluay50b1N0cmluZygpLnJlcGxhY2UoXCJcXFxcXCIsIFwiXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgT3duZXJfVVJMIDogJ2h0dHBzOi8vd3d3LmZsaWNrci5jb20vcGhvdG9zLycgKyBwaG90by5hdXRob3JfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBUaXRsZSAgICAgOiBwaG90by50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIERlc2NyaXB0aW9uOiBwaG90by5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIFB1Ymxpc2hlZF9kYXRlOiBtb21lbnQocGhvdG8ucHVibGlzaGVkKS5mb3JtYXQoJ01NIE1NTU0gWVlZWScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgQXV0aG9yOiBwaG90by5hdXRob3Iuc3Vic3RyaW5nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob3RvLmF1dGhvci5pbmRleE9mKFwiXFxcIlwiKSArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvdG8uYXV0aG9yLmxhc3RJbmRleE9mKFwiXFxcIlwiKSAtIDFcbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICBUYWdzOiBwaG90by50YWdzXG4gICAgICAgICAgICAgICAgICAgIH0pKVxuXG4gICAgICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHN1Y2Nlc3NSZXNwb25zZShcIlN1Y2Nlc3MgRmV0Y2ggRGF0YVwiLCBhbGxQaG90b3MpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDIyKS5qc29uKGVycm9yUmVzcG9uc2UoXCJzb21ldGhpbmcgd2VudCB3cm9uZyB3aGVuIHRyeWluZyB0byBmZXRjaCBkYXRhXCIsIGVycikpO1xuICAgIH1cbn0pOyAgIFxuXG5cbi8vIEdldCBJbWFnZXMgYmFzZWQgb24gSW1hZ2VzIFRhZ3NcbnJvdXRlci5nZXQoJy9mZWVkL3NlYXJjaC86dGFncycsIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0geyB0YWdzOiByZXEucGFyYW1zLnRhZ3MgfVxuICAgICAgICAgICAgLCBzZWFyY2hCeVRhZ3MgID0gYGh0dHBzOi8vd3d3LmZsaWNrci5jb20vc2VydmljZXMvcmVzdC8/bWV0aG9kPWZsaWNrci5waG90b3Muc2VhcmNoJmBcbiAgICAgICAgICAgICtgYXBpX2tleT1iNTI1ZjE0YTUzZmZmNjJhOTZjM2Q3YzM5MmIxM2FkNCZgXG4gICAgICAgICAgICArYHRhZ3M9JHtxdWVyeS50YWdzfSZmb3JtYXQ9anNvbiZub2pzb25jYWxsYmFjaz0xJmFwaV9zaWc9ZGFkMmU0NWY4Y2Q2ZjQ1NTVjMTZlNTBjYzFjNjA1NTJgXG5cbiAgICAgICAgcmVxdWVzdCh7XG4gICAgICAgICAgICB1cmwgOiBzZWFyY2hCeVRhZ3MsXG4gICAgICAgICAgICBqc29uOiB0cnVlXG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpIHtcbiAgICAgICAgICAgIGlmICghZXJyb3IgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlIGEgbmV3IG91dHB1dCBEYXRhIGFuZCBnZXQgdGhlIFBob3RvcyBkZXRhaWxcbiAgICAgICAgICAgICAgICBsZXQgYWxsUGhvdG9zID0gYm9keS5waG90b3MucGhvdG8ubWFwKHBob3RvID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIFN0YXRpY19VUkw6ICdodHRwczovL2Zhcm0nICsgcGhvdG8uZmFybSArICcuc3RhdGljZmxpY2tyLmNvbS8nICsgcGhvdG8uc2VydmVyICsgJy8nICsgcGhvdG8uaWQgKyAnXycgKyBwaG90by5zZWNyZXQgKyAnX2IuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgRmxpY2tyX1VSTDogJ2h0dHBzOi8vd3d3LmZsaWNrci5jb20vcGhvdG9zLycgKyBwaG90by5vd25lciArICcvJyArIHBob3RvLmlkLFxuICAgICAgICAgICAgICAgICAgICBPd25lcl9VUkwgOiAnaHR0cHM6Ly93d3cuZmxpY2tyLmNvbS9waG90b3MvJyArIHBob3RvLm93bmVyLFxuICAgICAgICAgICAgICAgICAgICBUaXRsZSAgICAgOiBwaG90by50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgLy8gUHVibGlzaGVkX2RhdGU6IG1vbWVudChwaG90by5wdWJsaXNoZWQpLmZvcm1hdCgnTU0gTU1NTSBZWVlZJyksXG4gICAgICAgICAgICAgICAgICAgIEF1dGhvciAgICA6IHBob3RvLm93bmVyLFxuICAgICAgICAgICAgICAgICAgICAvLyBUYWdzICAgICAgOiBwaG90by50YWdzXG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oc3VjY2Vzc1Jlc3BvbnNlKFwiU3VjY2VzcyBGZXRjaCBEYXRhXCIsIGFsbFBob3RvcykpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoNDIyKS5qc29uKGVycm9yUmVzcG9uc2UoYENhbm5vdCBmaW5kIHRoZSBwaG90b3Mgd2l0aCB0YWdzICR7cXVlcnl9YCwgZXJyb3IpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MjIpLmpzb24oZXJyb3JSZXNwb25zZShcIlRoZXJlIGlzIHNvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluIVwiLCBlcnIpKTtcbiAgICB9XG59KTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcblxuIl19